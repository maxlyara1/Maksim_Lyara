# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ

–†–µ—à–µ–Ω–∏–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –ø–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—é —Ü–µ–Ω–æ–≤—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏—è:**
- –ê–Ω—Å–∞–º–±–ª—å –∏–∑ 18 –º–æ–¥–µ–ª–µ–π CatBoost (Uncertainty + Quantile)
- Proxy validation –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ —É—Å–ª–æ–≤–∏–π —Ç–µ—Å—Ç–∞
- –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ —Å —É—á–µ—Ç–æ–º –Ω–æ–≤—ã—Ö/—Å—Ç–∞—Ä—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
- –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –¥–ª—è —É—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –Ω–∏–∂–Ω—é—é (`price_p05`) –∏ –≤–µ—Ä—Ö–Ω—é—é (`price_p95`) –≥—Ä–∞–Ω–∏—Ü—ã —Ü–µ–Ω–æ–≤–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞. –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –ø–æ –º–µ—Ç—Ä–∏–∫–µ **mean 1D Intersection over Union (IoU)** –º–µ–∂–¥—É –∏—Å—Ç–∏–Ω–Ω—ã–º–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏.

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ main.py                 # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Å –º–æ–¥–µ–ª—å—é –∏ –ø–∞–π–ø–ª–∞–π–Ω–æ–º
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îú‚îÄ‚îÄ EDA.ipynb          # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ EDA.md             # –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –ø–æ EDA
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ train.csv          # –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ test.csv           # –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ sample_submission.csv
‚îî‚îÄ‚îÄ results/
    ‚îî‚îÄ‚îÄ submission.csv      # –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
```

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

–†–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∞–Ω—Å–∞–º–±–ª—å –∏–∑ 18 –º–æ–¥–µ–ª–µ–π CatBoost** (9 –º–æ–¥–µ–ª–µ–π √ó 2 —Ç–∏–ø–∞):

1. **–ú–æ–¥–µ–ª–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏** (`RMSEWithUncertainty`) ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ä–µ–¥–Ω–µ–µ (Œº) –∏ –¥–∏—Å–ø–µ—Ä—Å–∏—é (œÉ¬≤) —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–µ–Ω –≤ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π —à–∫–∞–ª–µ
2. **–ö–≤–∞–Ω—Ç–∏–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏** (`MultiQuantile`) ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç –∫–≤–∞–Ω—Ç–∏–ª–∏ 0.05, 0.5, 0.95 –≤ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π —à–∫–∞–ª–µ

–û–±–∞ –ø–æ–¥—Ö–æ–¥–∞ –¥–æ–ø–æ–ª–Ω—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞: –º–æ–¥–µ–ª–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é –æ—Ü–µ–Ω–∫—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∞ –∫–≤–∞–Ω—Ç–∏–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ ‚Äî –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é –æ—Ü–µ–Ω–∫—É –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤.

### –ü–∞–π–ø–ª–∞–π–Ω —Ä–µ—à–µ–Ω–∏—è

–ù–∏–∂–µ —Å—Ö–µ–º–∞ —à–∞–≥–æ–≤, —á—Ç–æ–±—ã —á–µ–ª–æ–≤–µ–∫—É –≤–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã–ª–æ –ø—Ä–æ—â–µ –ø–æ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É:

- **–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä** ‚Äî `product_id`, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ `train_df` (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π).
- **Proxy new products** ‚Äî —Ç–æ–≤–∞—Ä—ã —Å –∏—Å—Ç–æ—Ä–∏–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ –æ–±—É—á–µ–Ω–∏—è, —á—Ç–æ–±—ã –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–∏—Ç–∏—Ä–æ–≤–∞–ª–∞ —Ö–æ–ª–æ–¥–Ω—ã–π —Å—Ç–∞—Ä—Ç.

```mermaid
flowchart TD
    A["–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö<br/>train.csv, test.csv"] --> B["–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–∞—Ä–≥–µ—Ç–æ–≤<br/>—Å—Ä–µ–¥–Ω–µ–µ/—Ä–∞–∑–±—Ä–æ—Å + –ª–æ–≥–∞—Ä–∏—Ñ–º"]
    B --> C["–û–∫–Ω–æ –æ–±—É—á–µ–Ω–∏—è<br/>–ø–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π"]
    C --> D["Feature Engineering"]
    
    D --> D1["–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤<br/>KMeans k=5"]
    D --> D2["Target Encoding<br/>KFold –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–π"]
    D --> D3["–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏<br/>–¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, –¥–µ–Ω—å –º–µ—Å—è—Ü–∞,<br/>–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–º,<br/>–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∞"]
    D --> D4["–î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π<br/>IsolationForest"]
    
    D1 --> E["Proxy validation split"]
    D2 --> E
    D3 --> E
    D4 --> E
    
    E --> E1["Proxy new products<br/>240 —Ç–æ–≤–∞—Ä–æ–≤, —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è"]
    E1 --> E2["Train: –±–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 30 –¥–Ω–µ–π<br/>–∏ –±–µ–∑ proxy new"]
    E1 --> E3["Val: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π<br/>–≤–∫–ª—é—á–∞—è proxy new"]
    
    E2 --> F["–û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª—è<br/>9 —Å–∏–¥–æ–≤ √ó 2 —Ç–∏–ø–∞ –º–æ–¥–µ–ª–µ–π"]
    E3 --> F
    E3 --> I["–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≥–∞–º–º<br/>–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è<br/>(–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤)"]
    
    F --> F1["Uncertainty models<br/>RMSEWithUncertainty"]
    F --> F2["Quantile models<br/>MultiQuantile"]
    
    F1 --> F3["Refit –Ω–∞ –ø–æ–ª–Ω–æ–º train<br/>+15% –∏—Ç–µ—Ä–∞—Ü–∏–π"]
    F2 --> F3
    
    F3 --> G["–£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π<br/>18 –º–æ–¥–µ–ª–µ–π"]
    G --> H["–ë–ª–µ–Ω–¥–∏–Ω–≥ —Å—Ä–µ–¥–Ω–µ–≥–æ/–¥–∏—Å–ø–µ—Ä—Å–∏–∏<br/>grid search –≤–µ—Å–æ–≤<br/>(—Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π –≥–∞–º–º)"]
    H --> I["–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≥–∞–º–º<br/>–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è"]
    
    I --> I1["–ì–ª–æ–±–∞–ª—å–Ω—ã–µ: –Ω–æ–≤—ã–µ/—Å—Ç–∞—Ä—ã–µ"]
    I --> I2["–ù–æ–≤—ã–µ: –ø–æ management_group_id"]
    I --> I3["–°—Ç–∞—Ä—ã–µ: –ø–æ cluster + activity"]
    
    I1 --> J["EWM-—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ<br/>—Ä–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã<br/>(—Ç—é–Ω–∏–Ω–≥ –Ω–∞ val)"]
    I2 --> J
    I3 --> J
    
    J --> K["–§–∏–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã<br/>–¥–ª—è test"]
    K --> L["results/submission.csv"]
```

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

#### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (`feature_engineering`)

- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤** (KMeans, k=5) –ø–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º: —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞, —Ä–∞–∑–±—Ä–æ—Å —Ü–µ–Ω, —á–∞—Å—Ç–æ—Ç–∞ –∞–∫—Ü–∏–π
- **Target Encoding** —Å KFold-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π –¥–ª—è –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- **–î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π** (IsolationForest) –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**: –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–º, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∞

#### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è (Proxy Validation)

–î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ —Ç—Ä–µ–π–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **proxy validation**, –∫–æ—Ç–æ—Ä–∞—è —Å–∏–º—É–ª–∏—Ä—É–µ—Ç —É—Å–ª–æ–≤–∏—è —Ç–µ—Å—Ç–∞:
- –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 30 –¥–Ω–µ–π –∫–∞–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
- –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–±–æ—Ä 240 —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ —Ç—Ä–µ–π–Ω–∞ –∫–∞–∫ "–ø—Ä–æ–∫—Å–∏ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤" (–ø–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é `management_group_id` –∏–∑ —Ç–µ—Å—Ç–∞)

#### 3. –ë–ª–µ–Ω–¥–∏–Ω–≥ –∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞

- **–ë–ª–µ–Ω–¥–∏–Ω–≥** –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –¥–≤—É—Ö —Ç–∏–ø–æ–≤ –º–æ–¥–µ–ª–µ–π:
  - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ Œº: `Œº_blend = w_mu √ó Œº_unc + (1 - w_mu) √ó q_p50`
  - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ œÉ: `œÉ_blend = w_sigma √ó œÉ_unc + (1 - w_sigma) √ó œÉ_quantile`, –≥–¥–µ `œÉ_quantile = (q_p95 - q_p05) / 3.29` (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–≤–∞–Ω—Ç–∏–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)
  - –í–µ—Å–∞ `w_mu` –∏ `w_sigma` –ø–æ–¥–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ grid search –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  
- **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≥–∞–º–º** (–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –º–Ω–æ–∂–∏—Ç–µ–ª–µ–π –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤) —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π:
  - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –≥–∞–º–º—ã –¥–ª—è –Ω–æ–≤—ã—Ö/—Å—Ç–∞—Ä—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
  - –ì—Ä—É–ø–ø–æ–≤—ã–µ –≥–∞–º–º—ã –ø–æ `management_group_id` (–¥–ª—è –Ω–æ–≤—ã—Ö)
  - –ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ –≥–∞–º–º—ã –ø–æ `cluster_id` (–¥–ª—è —Å—Ç–∞—Ä—ã—Ö)
  - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –≥–∞–º–º—ã –ø–æ –∫–ª–∞—Å—Ç–µ—Ä—É + –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  - –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã: `p05 = expm1(Œº - Œ≥_low √ó œÉ)`, `p95 = expm1(Œº + Œ≥_high √ó œÉ)`

#### 4. –ü–æ—Å—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥

- **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ** –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (EWM) –¥–ª—è —É—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (–ø–æ–¥–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ grid search)

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ –∫–ª–∞—Å—Å–µ `Config`:

- **–ê–Ω—Å–∞–º–±–ª—å**: 9 –º–æ–¥–µ–ª–µ–π —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (depth, rsm, bootstrap_type, bagging_temperature, subsample)
- **–û–∫–Ω–æ –æ–±—É—á–µ–Ω–∏—è**: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π –∏–∑ —Ç—Ä–µ–π–Ω–∞ (–¥–ª—è —É—á–µ—Ç–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤)
- **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∞–Ω—Å–∞–º–±–ª—è**: –≤–∞—Ä–∏–∞—Ü–∏–∏ –≥–ª—É–±–∏–Ω—ã –¥–µ—Ä–µ–≤—å–µ–≤ (¬±2 –æ—Ç –±–∞–∑–æ–≤–æ–π), sampling-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- **–§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏ –æ–±—É—á–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ –Ω–∞ –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å +15% –∏—Ç–µ—Ä–∞—Ü–∏–π –æ—Ç –ª—É—á—à–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–∑ –∫—É—Ä—Å–∞

–†–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥—ã, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –Ω–∞ –ª–µ–∫—Ü–∏—è—Ö:
- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** (KMeans) –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –ø–æ–≤–µ–¥–µ–Ω–∏—è
- **–î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π** (IsolationForest) –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
- **–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏** (RobustScaler) –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

## üìä –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

–ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤:
- **`notebooks/EDA.ipynb`** ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –Ω–æ—É—Ç–±—É–∫ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏
- **`notebooks/EDA.md`** ‚Äî –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç —Å –∫–ª—é—á–µ–≤—ã–º–∏ –≤—ã–≤–æ–¥–∞–º–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã –∏–∑ EDA –∏ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ

1. **–ù–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã** (150 —Ç–æ–≤–∞—Ä–æ–≤, 23.6% –æ—Ç —Ç–µ—Å—Ç–∞)
   - **–ü—Ä–æ–±–ª–µ–º–∞**: —Ç–æ–≤–∞—Ä—ã –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–µ–±—É—é—Ç –æ—Å–æ–±–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
   - **–†–µ—à–µ–Ω–∏–µ –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ**:
     - Proxy validation —Å —Å–∏–º—É–ª—è—Ü–∏–µ–π –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–±–æ—Ä –ø–æ `management_group_id`
     - –û—Ç–¥–µ–ª—å–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≥–∞–º–º –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ ‚Üí –≥—Ä—É–ø–ø–æ–≤—ã–µ –ø–æ `management_group_id`)
     - –ë—É—Å—Ç –≥–∞–º–º –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (`new_gamma_boost=1.04`) –¥–ª—è —É—á–µ—Ç–∞ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
     - –†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

2. **–í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å** (–∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è lag-1: 0.67 –¥–ª—è `price_p05`, 0.81 –¥–ª—è —à–∏—Ä–∏–Ω—ã)
   - **–ü—Ä–æ–±–ª–µ–º–∞**: —Ü–µ–Ω—ã —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - **–†–µ—à–µ–Ω–∏–µ –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ**:
     - –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (`_apply_smoothing`)
     - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `product_id` –∏ `dt` –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º EWM –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
     - –ü–æ–¥–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è (`smoothing_alpha_old`, `smoothing_alpha_new`) —á–µ—Ä–µ–∑ grid search

3. **–≠—Ñ—Ñ–µ–∫—Ç –∞–∫—Ü–∏–π** (`activity_flag=1` —Å–Ω–∏–∂–∞–µ—Ç —Ü–µ–Ω—ã –Ω–∞ ~14%, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —à–∏—Ä–∏–Ω—É –Ω–∞ ~86%)
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –∞–∫—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –º–µ–Ω—è—é—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ü–µ–Ω
   - **–†–µ—à–µ–Ω–∏–µ –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ**:
     - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `activity_flag` –≤ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ (–∞–≥—Ä–µ–≥–∞—Ü–∏—è `activity_flag.mean()`)
     - –ü—Ä–∏–∑–Ω–∞–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è `act_x_clust = activity_flag * cluster_id`
     - –î–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≥–∞–º–º –ø–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (`clusters_act`)
     - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `activity_flag` –≤ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π

4. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ–Ω—è—é—Ç—Å—è –ø–æ –¥–∞—Ç–∞–º –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤)
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ —Ç–æ–≤–∞—Ä–∞
   - **–†–µ—à–µ–Ω–∏–µ –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ**:
     - Target Encoding –¥–ª—è –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏ (`management_group_id`, `first_category_id`, `second_category_id`, `third_category_id`, `product_id`)
     - KFold-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏ Target Encoding –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö
     - –ë–∞–π–µ—Å–æ–≤—Å–∫–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Å—Ä–µ–¥–Ω–∏–º –¥–ª—è —Ä–µ–¥–∫–∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π

5. **–°–¥–≤–∏–≥ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π** (—Ç–µ—Å—Ç –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –ø–æ –ø–æ–≥–æ–¥–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º)
   - **–ü—Ä–æ–±–ª–µ–º–∞**: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ —Ç–µ—Å—Ç–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ç—Ä–µ–π–Ω–∞
   - **–†–µ—à–µ–Ω–∏–µ –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ**:
     - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 90 –¥–Ω–µ–π –∏–∑ —Ç—Ä–µ–π–Ω–∞ (`train_window_days=90`) –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –±–æ–ª–µ–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
     - Proxy validation —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 30 –¥–Ω–µ–π –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–¥–≤–∏–≥–∞
     - –°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ `management_group_id` –¥–ª—è —É—á–µ—Ç–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤ —Ç–µ—Å—Ç–µ
     - –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≥–∞–º–º –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –∫ —Ä–∞–∑–Ω—ã–º –≥—Ä—É–ø–ø–∞–º —Ç–æ–≤–∞—Ä–æ–≤

## üîç –ú–µ—Ç—Ä–∏–∫–∞ –æ—Ü–µ–Ω–∫–∏

**Mean 1D IoU** ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ø–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—é –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤:

```
IoU = intersection / union
–≥–¥–µ:
  intersection = max(0, min(U_true, U_pred) - max(L_true, L_pred))
  union = w_true + w_pred - intersection
  w_true = U_true - L_true + Œµ
  w_pred = U_pred - L_pred + Œµ
```

–ß–µ–º –≤—ã—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–µ–º –ª—É—á—à–µ (–º–∞–∫—Å–∏–º—É–º 1.0).

### –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

–í—Å–µ —Å–ª—É—á–∞–π–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–º —Å–∏–¥–æ–º (`system_seed=322`). –î–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –∞–Ω—Å–∞–º–±–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ —Å–∏–¥—ã, –Ω–æ –æ–Ω–∏ —Ç–∞–∫–∂–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è:**

- **Private Leaderboard**: **2-–µ –º–µ—Å—Ç–æ** —Å score **0.265574** (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –Ω–∞ 60% —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- **Public Leaderboard**: **3-–µ –º–µ—Å—Ç–æ** —Å score **0.272687** (–æ—Ü–µ–Ω–∫–∞ –Ω–∞ 40% —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö)

–†–µ—à–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –æ–±–æ–∏—Ö –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞—Ö, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–æ–¥—Ö–æ–¥–∞ –∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ –º–æ–¥–µ–ª–∏.
